apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: {{ secret.nameOverride | default(app.name+'-'+secret.name) }}
  namespace: {{ app.namespace }}
{% if 'type' in secret.value %}
type: kubernetes.io/{{ secret.value.type }}
{% endif %}
{% if 'data' in secret.value and secret.value.data is mapping %}
data:
{% for key,value in secret.value.data | items %}
  {{ key }}: {{ (key in generated_credentials) | ternary(generated_credentials[key], value) | b64encode }}
{% endfor %}
{% endif %}
{% if 'stringData' in secret.value %}
stringData:
{{ secret.value.stringData | to_nice_yaml(indent=4) }}
{% endif %}
