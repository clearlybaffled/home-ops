---
- name: Install prometheus CRDs
  kubernetes.core.k8s:
    resource_definition: "{{ lookup('url', url, split_lines=false) }}"
  loop: 
        - alertmanagerconfigs
        - alertmanagers
        - podmonitors
        - probes
        - prometheusagents
        - prometheuses
        - prometheusrules
        - scrapeconfigs
        - servicemonitors
        - thanosrulers
  vars:
    url: "https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/{{ prometheus_operator_version }}/example/prometheus-operator-crd/monitoring.coreos.com_{{ item }}.yaml"
