---
- name: Generate a random password # noqa risky-shell-pipe
  ansible.builtin.shell:
    cmd: |-
      </dev/urandom tr -cd '[:graph:]' | fold -w {{ length | default(30) }} | head -n1
  register: password
- name: Set return value
  set_fact:
    "{{user}}_password": "{{ password.stdout }}"
