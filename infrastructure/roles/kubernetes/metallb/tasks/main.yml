---
- name: Kubernetes Apps | Create MetalLB resources and replace existing
  kubernetes.core.k8s:
    src: "https://raw.githubusercontent.com/metallb/metallb/{{ metallb_version }}/config/manifests/metallb-native.yaml"
    wait: false
    wait_sleep: 10
    wait_timeout: 120
    wait_condition:
      status: "True"
      type: Available

- name: Kubernetes Apps | Install and configure MetalLB
  kubernetes.core.k8s:
    name: "MetalLB"
    template: "{{ item }}.yaml.j2"
  with_list:
    - pools
    - layer2
