---
- name: Restart crio
  command: /bin/true
  changed_when: false
  notify:
    - CRI-O | reload systemd
    - CRI-O | reload crio

- name: CRI-O | reload systemd
  systemd:
    daemon_reload: true

- name: CRI-O | reload crio
  service:
    name: crio
    state: restarted
    enabled: true

- name: Get crictl completion
  ansible.builtin.command: "{{ bin_dir }}/crictl completion"
  changed_when: false
  register: cri_completion
  check_mode: false

- name: Install crictl completion
  ansible.builtin.copy:
    dest: /etc/bash_completion.d/crictl
    content: "{{ cri_completion.stdout }}"
    mode: "0644"
