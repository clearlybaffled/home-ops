config:
  existingSecret: oauth2-proxy-secret
  configFile: |-
    provider = "keycloak-oidc"
    provider_display_name = "Keycloak"
    oidc_issuer_url = "https://keycloak.hermleigh.home/realms/hermleigh.home"
    email_domains = [ "*" ]
    scope = "openid profile email"
    whitelist_domains = ".hermleigh.home"
    pass_authorization_header = true
    pass_access_token = true
    pass_user_headers = true
    set_authorization_header = true
    set_xauthrequest = true
    use_system_trust_store = true
    reverse_proxy = true
    redis_connection_url = "redis://redis-master.db"
    session_store_type = "redis"
    code_challenge_method = "S256"

ingress:
  enabled: true
  path: /
  hosts:
    - oauth.sso.hermleigh.home
  annotations:
    cert-manager.io/cluster-issuer: ca-issuer
    nginx.ingress.kubernetes.io/proxy-buffer-size: "16k"
  tls:
    - secretName: oauth-proxy-tls
      hosts:
        - oauth.sso.hermleigh.home

extraArgs:
  - '--provider-ca-file=/var/run/secrets/kubernetes.io/serviceaccount/ca.crt'
