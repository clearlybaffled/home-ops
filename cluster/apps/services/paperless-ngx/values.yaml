global:
  nameOverride: paperless

controllers:
  main:
    type: deployment
    containers:
      main:
        image:
          repository: ghcr.io/paperless-ngx/paperless-ngx
          tag: 1.17.4
        env:
          PAPERLESS_CONSUMER_POLLING: 60
          PAPERLESS_CONSUMER_RECURSIVE: "true"
          PAPERLESS_CONSUMER_SUBDIRS_AS_TAGS: "true"
          PAPERLESS_CONSUMPTION_DIR: /consume
          PAPERLESS_DBENGINE: postgresql
          PAPERLESS_DBHOST: cnpg-cluster-rw.db.svc
          PAPERLESS_DATA_DIR: /library/data
          PAPERLESS_EXPORT_DIR: /library/export
          PAPERLESS_MEDIA_ROOT: /library/media
          PAPERLESS_TRASH_DIR: /trash
          PAPERLESS_OCR_LANGUAGE: eng
          PAPERLESS_OCR_MODE: skip
          PAPERLESS_OCR_ROTATE_PAGES: "true"
          PAPERLESS_OCR_IMAGE_DPI: 300
          PAPERLESS_PORT: &port 8080
          PAPERLESS_TASK_WORKERS: 2
          PAPERLESS_TIME_ZONE: &tz America/New_York
          PAPERLESS_TIKA_ENABLED: 1
          PAPERLESS_TIKA_GOTENBERG_ENDPOINT: http://localhost:3000
          PAPERLESS_TIKA_ENDPOINT: http://localhost:9998
          PAPERLESS_URL: https://paperless.hermleigh.home
          PAPERLESS_REDIS: redis://redis-master.db.svc:6379
          USERMAP_UID: 997
          USERMAP_GID: 997
          TZ: America/New_York
        envFrom:
          - secretRef:
              name: paperless-ngx-secret
        resources:
          requests:
            cpu: 100m
            memory: 1000Mi
          limits:
            memory: 5000Mi

      gotenburg:
        image:
          repository: thecodingmachine/gotenberg
          tag: 7.8.3
        imagePullPolicy: IfNotPresent
        env:
          - name: DISABLE_GOOGLE_CHROME
            value: "1"

      tika:
        image:
          repository: ghcr.io/paperless-ngx/tika
          tag: 2.7.0-full
        imagePullPolicy: IfNotPresent

      hp-scan-to:
        image:
          repository: manuc66/node-hp-scan-to
          tag: master
        env:
          - name: IP
            value: 172.16.1.180
          - name: PATTERN
            value: '"scan"_dd.mm.yyyy_hh:MM:ss'
          - name: PGID
            value: "997"
          - name: PUID
            value: "997"
          - name: LABEL
            value: paperless-ngx
          - name: RESOLUTION
            value: 300
          - name: DIR
            value: /consume
          - name: TZ
            value: *tz
          - name: CMDLINE
            value: "-D -l paperless-ngx -r 300 "
        resources:
          limits:
            memory: 256Mi
          requests:
            cpu: "0"
            memory: 64Mi

service:
  main:
    ports:
      http:
        port: *port
ingress:
  main:
    enabled: true
    className: nginx
    annotations:
      hajimari.io/icon: arcticons:paperless
      cert-manager.io/cluster-issuer: ca-issuer
    hosts:
      - host: &host paperless.hermleigh.home
        paths:
          - path: /
            service:
              name: main
              port: http
    tls:
      - hosts:
          - *host
          - paperless
          - paperless.apps
          - paperless.apps.svc
        secretName: paperless-tls-ingress

persistence:
  library:
    enabled: true
    type: persistentVolumeClaim
    mountPath: /library
    accessMode: ReadWriteMany
    size: 30Gi
    storageClass: ceph-fs-ssd
  trash:
    enabled: true
    type: emptyDir
    mountPath: /trash
  consume:
    existingClaim: paperless-consume

defaultPodOptions:
  podSecurityContext:
    # runAsUser: 997
    # runAsGroup: 997
    fsGroup: 997
