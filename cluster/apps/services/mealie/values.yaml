image:
  repository: ghcr.io/mealie-recipes/mealie
  tag: v1.0.0-RC1.1
  pullPolicy: IfNotPresent

service:
  main:
    ports:
      http:
        port: 9000

env: &env
  TZ: America/New_York
  DB_ENGINE: postgres
  PUID: 997
  PGID: 997

envFrom:
  - secretRef:
      name: mealie-secret

ingress:
  main:
    enabled: true
    ingressClassName: nginx
    annotations:
      hajimari.io/icon: chef-hat
      cert-manager.io/cluster-issuer: ca-issuer
    hosts:
      - host: &host mealie.seawolf.hermleigh.home
        paths:
          - path: /
            pathType: Prefix
            services:
              port: http
              name: main
    tls:
      - secretName: mealie-tls-ingress
        hosts:
          - *host
persistence:
  api-data:
    enabled: true
    mountPath: /app/data/
    accessMode: ReadWriteOnce
    size: 10Gi
    storageClass: ceph-fs-hdd
    retain: true

additionalContainers:
  api:
    image: hkotel/mealie:api-v1.0.0beta-5
    imagePullPolicy: IfNotPresent

    env:
      <<: *env
      DB_ENGINE: postgres
      POSTGRES_SERVER: cnpg-cluster-rw.db.svc
      POSTGRES_DB: mealie

    envFrom:
      - secretRef:
          name: mealie-secret

    volumeMounts:
      - name: api-data
        mountPath: /app/data/
